# 中国姓氏到日语发音的映射 - 尽可能包含所有常见姓氏
chinese_surname_map = {
    # Top 100 common Chinese surnames
    '王': 'オウ', '李': 'リ', '张': 'チョウ', '刘': 'リュウ', '陈': 'チン',
    '杨': 'ウウ', '黄': 'コウ', '赵': 'チョウ', '周': 'シュウ', '吴': 'ゴ',
    '徐': 'ジョ', '孙': 'ソン', '胡': 'コ', '朱': 'シュ', '高': 'コウ',
    '林': 'リン', '何': 'カ', '郭': 'カク', '马': 'バ', '罗': 'ラ',
    '梁': 'リョウ', '宋': 'ソウ', '郑': 'テイ', '谢': 'シャ', '韩': 'カン',
    '唐': 'トウ', '冯': 'フウ', '于': 'ウ', '董': 'トウ', '萧': 'ショウ',
    '程': 'テイ', '曹': 'ソウ', '袁': 'エン', '邓': 'トウ', '许': 'キョ',
    '傅': 'フ', '沈': 'チン', '曾': 'ソウ', '彭': 'ホウ', '吕': 'ロ',
    '苏': 'ソ', '卢': 'ロ', '蒋': 'ショウ', '蔡': 'サイ', '贾': 'カ',
    '丁': 'テイ', '魏': 'ギ', '薛': 'セツ', '叶': 'ヨウ', '阎': 'エン',
    '余': 'ヨ', '潘': 'ハン', '杜': 'ト', '戴': 'タイ', '夏': 'カ',
    '钟': 'ショウ', '汪': 'オウ', '田': 'デン', '任': 'ニン', '姜': 'キョウ',
    '范': 'ハン', '方': 'ホウ', '石': 'セキ', '姚': 'ヨウ', '谭': 'タン',
    '廖': 'リョウ', '邹': 'スウ', '熊': 'ユウ', '金': 'キン', '陆': 'リク',
    '郝': 'カク', '孔': 'コウ', '白': 'ハク', '崔': 'サイ', '康': 'コウ',
    '毛': 'モウ', '邱': 'キュウ', '秦': 'シン', '江': 'コウ', '史': 'シ',
    '顾': 'コ', '侯': 'コウ', '邵': 'ショウ', '孟': 'モウ', '龙': 'リュウ',
    '万': 'バン', '段': 'タン', '漕': 'ソウ', '钱': 'セン', '汤': 'トウ',
    '尹': 'イン', '黎': 'レイ', '易': 'イ', '常': 'ジョウ', '武': 'ブ',
    '乔': 'キョウ', '贺': 'ガ', '赖': 'ライ', '龚': 'キョウ', '文': 'ブン',
    
    # Compound surnames
    '欧阳': 'オウヨウ', '上官': 'ジョウカン', '司马': 'シバ', '诸葛': 'ショカツ',
    '司徒': 'シト', '司空': 'シクウ', '公孙': 'コウソン', '东方': 'トウホウ',
    '皇甫': 'コウホ', '尉迟': 'イチ', '公羊': 'コウヨウ', '澹台': 'タンダイ',
    '申屠': 'シント', '太叔': 'タイシュク', '轩辕': 'ケンエン', '令狐': 'レイコ',
    '钟离': 'チュウリ', '宇文': 'ウンブン', '长孙': 'チョウソン', '慕容': 'ボクヨウ',
    
    # Common surnames of ethnic minorities
    '阿': 'ア', '艾': 'ガイ', '白': 'ハク', '拜': 'ハイ', '包': 'ホウ',
    '曹': 'ソウ', '达': 'タツ', '德': 'トク', '董': 'トウ', '多': 'タ',
    '额': 'ガク', '鄂': 'ガク', '范': 'ハン', '方': 'ホウ', '傅': 'フ',
    '高': 'コウ', '格': 'カク', '顾': 'コ', '关': 'カン', '郭': 'カク',
    '海': 'カイ', '韩': 'カン', '何': 'カ', '和': 'ワ', '贺': 'ガ',
    '黄': 'コウ', '霍': 'カク', '姬': 'キ', '金': 'キン', '景': 'ケイ',
    '康': 'コウ', '蓝': 'ラン', '郎': 'ロウ', '雷': 'ライ', '黎': 'レイ',
    '李': 'リ', '梁': 'リョウ', '林': 'リン', '凌': 'リョウ', '刘': 'リュウ',
    '龙': 'リュウ', '卢': 'ロ', '鲁': 'ロ', '陆': 'リク', '罗': 'ラ',
    '马': 'バ', '毛': 'モウ', '孟': 'モウ', '米': 'ベイ', '莫': 'バク',
    '木': 'ボク', '那': 'ナ', '南': 'ナン', '倪': 'ゲイ', '宁': 'ネイ',
    '牛': 'ギュウ', '潘': 'ハン', '庞': 'ホウ', '裴': 'ハイ', '彭': 'ホウ',
    '蒲': 'ホ', '戚': 'セキ', '齐': 'セイ', '钱': 'セン', '强': 'キョウ',
    '秦': 'シン', '邱': 'キュウ', '秋': 'シュウ', '屈': 'クツ', '阮': 'ゲン',
    '桑': 'ソウ', '沙': 'サ', '单': 'セン', '尚': 'ショウ', '邵': 'ショウ',
    '沈': 'チン', '施': 'セ', '石': 'セキ', '时': 'ジ', '史': 'シ',
    '苏': 'ソ', '孙': 'ソン', '索': 'サク', '唐': 'トウ', '陶': 'トウ',
    '田': 'デン', '佟': 'トウ', '童': 'ドウ', '涂': 'ト', '屠': 'ト',
    '万': 'バン', '汪': 'オウ', '王': 'オウ', '韦': 'イ', '卫': 'エイ',
    '魏': 'ギ', '温': 'オン', '文': 'ブン', '翁': 'オウ', '吴': 'ゴ',
    '伍': 'ゴ', '武': 'ブ', '席': 'セキ', '夏': 'カ', '向': 'コウ',
    '肖': 'ショウ', '萧': 'ショウ', '谢': 'シャ', '熊': 'ユウ', '徐': 'ジョ',
    '许': 'キョ', '薛': 'セツ', '阎': 'エン', '严': 'ゲン', '颜': 'ガン',
    '杨': 'ウウ', '姚': 'ヨウ', '叶': 'ヨウ', '易': 'イ', '殷': 'イン',
    '尹': 'イン', '尤': 'ユウ', '游': 'ユウ', '于': 'ウ', '余': 'ヨ',
    '俞': 'ユ', '虞': 'ギョ', '元': 'ゲン', '袁': 'エン', '岳': 'ガク',
    '云': 'ウン', '宰': 'サイ', '臧': 'ソウ', '曾': 'ソウ', '翟': 'チャク',
    '詹': 'セン', '张': 'チョウ', '章': 'ショウ', '赵': 'チョウ', '郑': 'テイ',
    '钟': 'ショウ', '周': 'シュウ', '朱': 'シュ', '诸': 'ショ', '祝': 'シュク',
    '庄': 'ソウ', '卓': 'タク', '宗': 'ソウ', '邹': 'スウ',
}

# Common Chinese given names to Japanese pronunciation mapping
chinese_given_name_map = {
    # Common single-character given names
    '伟': 'イ', '芳': 'ホウ', '娜': 'ナ', '秀英': 'シュウエイ',
    '敏': 'ビン', '静': 'セイ', '强': 'キョウ', '磊': 'ライ',
    '军': 'グン', '洋': 'ヨウ', '勇': 'ユウ', '杰': 'ケツ',
    '丽': 'レイ', '娜': 'ナ', '敏': 'ビン', '静': 'セイ',
    '燕': 'エン', '玲': 'レイ', '秀': 'シュウ', '霞': 'カ',
    '平': 'ヘイ', '刚': 'ゴウ', '明': 'メイ', '辉': 'キ',
    '超': 'チョウ', '飞': 'ヒ', '阳': 'ヨウ', '峰': 'ホウ',
    '波': 'ハ', '涛': 'トウ', '亮': 'リョウ', '燕': 'エン',
    '艳': 'エン', '红': 'コウ', '梅': 'バイ', '丹': 'タン',
    '雪': 'セツ', '冰': 'ヒョウ', '雨': 'ウ', '风': 'フウ',
    '云': 'ウン', '龙': 'リュウ', '虎': 'コ', '鹏': 'ホウ',
    '凤': 'ホウ', '琳': 'リン', '晶': 'ショウ', '瑶': 'ヨウ',
    '莹': 'エイ', '娜': 'ナ', '倩': 'セン', '婷': 'テイ',
    '慧': 'ケイ', '颖': 'エイ', '瑾': 'キン', '璇': 'セン',
    '轩': 'ケン', '宇': 'ウ', '浩': 'コウ', '博': 'ハク',
    '思': 'シ', '哲': 'テツ', '涵': 'カン', '润': 'ジュン',
    '泽': 'タク', '洋': 'ヨウ', '晨': 'シン', '曦': 'ギ',
    '光': 'コウ', '亮': 'リョウ', '磊': 'ライ', '鑫': 'キン',
    '森': 'シン', '淼': 'ビョウ', '焱': 'エン', '垚': 'ギョウ',
    '龙': 'リュウ', '虎': 'コ', '狮': 'シ', '豹': 'ヒョウ',
    '熊': 'ユウ', '鹰': 'ヨウ', '鹤': 'カク', '麟': 'リン',
    '凤': 'ホウ', '凰': 'オウ', '鸳': 'エン', '鸯': 'オウ',
    '耀': 'ヨウ',  # Added '耀' character mapping
    
    # Common two-character given names
    '建国': 'ケンコク', '建军': 'ケングン', '建伟': 'ケンイ',
    '红梅': 'コウバイ', '秀丽': 'シュウレイ', '志强': 'シキョウ',
    '文静': 'ブンセイ', '小明': 'ショウメイ', '小红': 'ショウコウ',
    '小华': 'ショウカ', '小丽': 'ショウレイ', '小刚': 'ショウゴウ',
    '大勇': 'ダイユウ', '大明': 'ダイメイ', '大国': 'ダイコク',
    '志强': 'シキョウ', '志远': 'シエン', '志坚': 'シケン',
    '志国': 'シコク', '志伟': 'シイ', '志明': 'シメイ',
    '志勇': 'シユウ', '志豪': 'シゴウ', '志杰': 'シケツ',
    '俊杰': 'シュンケツ', '俊豪': 'シュンゴウ', '俊伟': 'シュンイ',
    '俊男': 'シュンダン', '俊丽': 'シュンレイ', '俊美': 'シュンビ',
    '秀丽': 'シュウレイ', '秀芳': 'シュウホウ', '秀兰': 'シュウラン',
    '秀琴': 'シュウキン', '秀梅': 'シュウバイ', '秀菊': 'シュウキク',
    '秀华': 'シュウカ', '秀英': 'シュウエイ', '秀清': 'シュウセイ',
    '秀英': 'シュウエイ', '秀荣': 'シュウエイ', '秀凤': 'シュウホウ',
    '秀红': 'シュウコウ', '秀玉': 'シュウギョク', '秀珍': 'シュウチン',
    '秀珠': 'シュウシュ', '秀芬': 'シュウフン', '秀燕': 'シュウエン',
    '秀玲': 'シュウレイ', '秀娜': 'シュウナ', '秀敏': 'シュウビン',
    '秀静': 'シュウセイ', '秀雅': 'シュウガ', '秀娟': 'シュウケン',
    '秀霞': 'シュウカ', '秀慧': 'シュウケイ', '秀颖': 'シュウエイ',
    '秀娜': 'シュウナ', '秀婷': 'シュウテイ', '秀芳': 'シュウホウ',
    '秀荣': 'シュウエイ', '秀凤': 'シュウホウ', '秀红': 'シュウコウ',
    '秀玉': 'シュウギョク', '秀珍': 'シュウチン', '秀珠': 'シュウシュ',
    '秀芬': 'シュウフン', '秀燕': 'シュウエン', '秀玲': 'シュウレイ',
    
    # Uncommon names
    '喆': 'テツ', '垚': 'ギョウ', '焱': 'エン', '淼': 'ビョウ',
    '鑫': 'キン', '森': 'シン', '品': 'ヒン', '犇': 'ホン',
    '骉': 'ビョウ', '羴': 'セン', '猋': 'ヒョウ', '麤': 'ソ',
    '鱻': 'セン', '赑': 'ヒ', '众': 'シュウ', '毳': 'サイ',
    '掱': 'ショウ', '矗': 'チョク', '晶': 'ショウ', '磊': 'ライ',
    '奸': 'カン', '轰': 'ゴウ', '聂': 'ジョウ', '嚞': 'テツ',
    '舙': 'カ', '瞐': 'メイ', '馫': 'キン', '飍': 'ヒョウ',
    '灥': 'セン', '靐': 'ヘイ', '飝': 'ヒ', '巛': 'セン',
    '厵': 'ゲン', '灋': 'ホウ', '麣': 'エン', '虤': 'ガン',
    '龘': 'タツ', '齉': 'ノウ', '齾': 'アイ', '爩': 'エツ',
    '麷': 'ホウ', '灪': 'エン', '籲': 'ヨ', '癵': 'レン',
    '驫': 'ビョウ', '麤': 'ソ', '鬰': 'オツ', '爨': 'サン',
    '齽': 'ギン', '齺': 'ソウ', '龗': 'レイ', '麢': 'リン',
    '龖': 'タツ', '鱻': 'セン', '灥': 'セン', '靐': 'ヘイ',
}

# Chinese pinyin mapping (for character-level transliteration)
chinese_pinyin_map = {
    # Initial consonants mapping
    'b': 'バ', 'p': 'パ', 'm': 'マ', 'f': 'フ',
    'd': 'ダ', 't': 'タ', 'n': 'ナ', 'l': 'ラ',
    'g': 'ガ', 'k': 'カ', 'h': 'ハ',
    'j': 'ジ', 'q': 'チ', 'x': 'シ',
    'zh': 'ジャ', 'ch': 'チャ', 'sh': 'シャ', 'r': 'ラ',
    'z': 'ズ', 'c': 'ツ', 's': 'ス',
    'y': 'ヤ', 'w': 'ワ',
    
    # Finals mapping (simplified version)
    'a': 'ア', 'o': 'オ', 'e': 'エ', 'i': 'イ',
    'u': 'ウ', 'v': 'ヴ', 'ai': 'アイ', 'ei': 'エイ',
    'ui': 'ウイ', 'ao': 'アオ', 'ou': 'オウ', 'iu': 'イウ',
    'ie': 'イエ', 've': 'ヴェ', 'er': 'ア', 'an': 'アン',
    'en': 'エン', 'in': 'イン', 'un': 'ウン', 'vn': 'ヴン',
    'ang': 'アング', 'eng': 'エング', 'ing': 'イング', 'ong': 'オング',
}

# Get Japanese pronunciation of a name
def get_japanese_pronunciation(name):
    # First check if the full name is in the given name mapping
    if name in chinese_given_name_map:
        return chinese_given_name_map[name]
    
    # Check if the surname is in the surname mapping (for full names)
    if len(name) >= 2:
        surname = name[0]
        if surname in chinese_surname_map:
            # Process surname
            result = chinese_surname_map[surname]
            # Process given name part
            given_name = name[1:]
            # Check if the entire given name part is in the mapping
            if given_name in chinese_given_name_map:
                result += chinese_given_name_map[given_name]
            else:
                # Process given name character by character - check both given_name_map and surname_map
                for char in given_name:
                    if char in chinese_given_name_map:
                        result += chinese_given_name_map[char]
                    elif char in chinese_surname_map:
                        result += chinese_surname_map[char]
                    else:
                        # If a character is not in the mapping, try pinyin to kana transliteration
                        result += transliterate_based_on_pinyin(char)
            return result
    
    # Check each character of the name in the mapping (for single-character names or compound surnames)
    result = ''
    for char in name:
        if char in chinese_given_name_map:
            result += chinese_given_name_map[char]
        elif char in chinese_surname_map:
            result += chinese_surname_map[char]
        else:
            # If a character is not in the mapping, try pinyin to kana transliteration
            result += transliterate_based_on_pinyin(char)
    
    return result if result else name

# Character-level transliteration based on pinyin (as last fallback)
def transliterate_based_on_pinyin(name):
    # Simple Chinese character to kana rules, based on common pronunciation patterns
    # A simplified rule is used here; more complex rules may be needed in practical applications
    
    # Direct mapping of common Chinese characters to kana (as supplement)
    direct_map = {
        '一': 'イチ', '二': 'ニ', '三': 'サン', '四': 'シ', '五': 'ゴ',
        '六': 'ロク', '七': 'シチ', '八': 'ハチ', '九': 'キュウ', '十': 'ジュウ',
        '百': 'ヒャク', '千': 'セン', '万': 'マン', '亿': 'オク',
        '上': 'ジョウ', '下': 'カ', '左': 'サ', '右': 'ウ',
        '前': 'ゼン', '后': 'ゴ', '中': 'チュウ', '外': 'ガイ',
        '大': 'ダイ', '小': 'ショウ', '多': 'タ', '少': 'ショウ',
        '高': 'コウ', '低': 'テイ', '长': 'チョウ', '短': 'タン',
        '男': 'ダン', '女': 'ジョ', '老': 'ロウ', '少': 'ショウ',
        '东': 'トウ', '南': 'ナン', '西': 'セイ', '北': 'ホク',
        '春': 'シュン', '夏': 'カ', '秋': 'シュウ', '冬': 'トウ',
    }
    
    result = ''
    for char in name:
        # 首先检查是否有直接映射
        if char in direct_map:
            result += direct_map[char]
        else:
            # For characters without direct mapping, keep the original character
            result += char
    
    return result